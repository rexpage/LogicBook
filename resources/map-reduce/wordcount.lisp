(include-book "map-reduce")

(defconst *WORDCOUNT*
  '((four 1)
    (score 1)
    (and 1)
    (seven 1)
    (years 1)
    (ago 1)
    (our 1)
    (fathers 1)
    (brought 1)
    (forth 1)
    (upon 1)
    (this 1)
    (continent 1)
    (a 1)
    (new 1)
    (nation 1)
    (conceived 1)
    (in 1)
    (liberty 1)
    (and 1)
    (dedicated 1)
    (to 1)
    (the 1)
    (proposition 1)
    (that 1)
    (all 1)
    (men 1)
    (are 1)
    (created 1)
    (equal 1)
    (now 1)
    (we 1)
    (are 1)
    (engaged 1)
    (in 1)
    (a 1)
    (great 1)
    (civil 1)
    (war 1)
    (testing 1)
    (whether 1)
    (that 1)
    (nation 1)
    (or 1)
    (any 1)
    (nation 1)
    (so 1)
    (conceived 1)
    (and 1)
    (so 1)
    (dedicated 1)
    (can 1)
    (long 1)
    (endure 1)
    (we 1)
    (are 1)
    (met 1)
    (here 1)
    (on 1)
    (a 1)
    (great 1)
    (battlefield 1)
    (of 1)
    (that 1)
    (war 1)
    (we 1)
    (have 1)
    (come 1)
    (to 1)
    (dedicate 1)
    (a 1)
    (portion 1)
    (of 1)
    (it 1)
    (as 1)
    (a 1)
    (final 1)
    (resting 1)
    (place 1)
    (for 1)
    (those 1)
    (who 1)
    (here 1)
    (gave 1)
    (their 1)
    (lives 1)
    (that 1)
    (that 1)
    (nation 1)
    (might 1)
    (live 1)
    (it 1)
    (is 1)
    (altogether 1)
    (fitting 1)
    (and 1)
    (proper 1)
    (that 1)
    (we 1)
    (should 1)
    (do 1)
    (this 1)
    (but 1)
    (in 1)
    (a 1)
    (larger 1)
    (sense 1)
    (we 1)
    (can 1)
    (not 1)
    (dedicate 1)
    (we 1)
    (can 1)
    (not 1)
    (consecrate 1)
    (we 1)
    (can 1)
    (not 1)
    (hallow 1)
    (this 1)
    (ground 1)
    (the 1)
    (brave 1)
    (men 1)
    (living 1)
    (and 1)
    (dead 1)
    (who 1)
    (struggled 1)
    (here 1)
    (have 1)
    (consecrated 1)
    (it 1)
    (far 1)
    (above 1)
    (our 1)
    (poor 1)
    (power 1)
    (to 1)
    (add 1)
    (or 1)
    (detract 1)
    (the 1)
    (world 1)
    (will 1)
    (little 1)
    (note 1)
    (nor 1)
    (long 1)
    (remember 1)
    (what 1)
    (we 1)
    (say 1)
    (here 1)
    (but 1)
    (can 1)
    (never 1)
    (forget 1)
    (what 1)
    (they 1)
    (did 1)
    (here 1)
    (it 1)
    (is 1)
    (for 1)
    (us 1)
    (the 1)
    (living 1)
    (rather 1)
    (to 1)
    (be 1)
    (dedicated 1)
    (here 1)
    (to 1)
    (the 1)
    (unfinished 1)
    (work 1)
    (which 1)
    (they 1)
    (have 1)
    (thus 1)
    (far 1)
    (so 1)
    (nobly 1)
    (carried 1)
    (on 1)
    (it 1)
    (is 1)
    (rather 1)
    (for 1)
    (us 1)
    (to 1)
    (be 1)
    (here 1)
    (dedicated 1)
    (to 1)
    (the 1)
    (great 1)
    (task 1)
    (remaining 1)
    (before 1)
    (us 1)
    (that 1)
    (from 1)
    (these 1)
    (honored 1)
    (dead 1)
    (we 1)
    (take 1)
    (increased 1)
    (devotion 1)
    (to 1)
    (that 1)
    (cause 1)
    (for 1)
    (which 1)
    (they 1)
    (here 1)
    (gave 1)
    (the 1)
    (last 1)
    (full 1)
    (measure 1)
    (of 1)
    (devotion 1)
    (that 1)
    (we 1)
    (here 1)
    (highly 1)
    (resolve 1)
    (that 1)
    (these 1)
    (dead 1)
    (shall 1)
    (not 1)
    (have 1)
    (died 1)
    (in 1)
    (vain 1)
    (that 1)
    (this 1)
    (nation 1)
    (shall 1)
    (have 1)
    (a 1)
    (new 1)
    (birth 1)
    (of 1)
    (freedom 1)
    (and 1)
    (that 1)
    (this 1)
    (government 1)
    (of 1)
    (the 1)
    (people 1)
    (by 1)
    (the 1)
    (people 1)
    (for 1)
    (the 1)
    (people 1)
    (shall 1)
    (not 1)
    (perish 1)
    (from 1)
    (the 1)
    (earth 1)
    ))

(defun wc-map (key value)
  (list (list key value)))

(defun sumlist (values)
  (if (consp values)
      (+ (first values)
	 (sumlist (rest values)))
      0))

(defun wc-reduce (key values)
  (list (list key (sumlist values))))

(defmapreduce wordcount wc-map wc-reduce)

(wordcount *WORDCOUNT*)